(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/main.js":[function(require,module,exports){
'use strict';

var height = 648;
var width = height*16/9;
var game = new Phaser.Game(width, height, Phaser.AUTO, 'roosevelt-game');

window.Utils = require('./utils');
window.playerState = {currentLevel: 'Game'};

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

},{"./states/boot":"/Users/moret/dev/roosevelt/src/js/states/boot.js","./states/game":"/Users/moret/dev/roosevelt/src/js/states/game.js","./states/menu":"/Users/moret/dev/roosevelt/src/js/states/menu.js","./states/preloader":"/Users/moret/dev/roosevelt/src/js/states/preloader.js","./states/splash":"/Users/moret/dev/roosevelt/src/js/states/splash.js","./utils":"/Users/moret/dev/roosevelt/src/js/utils.js"}],"/Users/moret/dev/roosevelt/src/js/entities/player.js":[function(require,module,exports){
var Player = function (game, x, y) {
  Phaser.Sprite.call(this, game, x, y, 'ninja', 'Idle__001.png');
  game.add.existing(this);
  this.anchor.setTo(0.5, 0.55);

  this.attackAnimation = this.animations.add(
    'attack', Phaser.Animation.generateFrameNames('Attack__', 1, 10, '.png', 3),
    24, false, false
  );
  this.attackAnimation.onComplete.add(this.attackFinished, this);

  this.animations.add(
    'run', Phaser.Animation.generateFrameNames('Run__', 1, 10, '.png', 3),
    24, true, false
  );

  this.animations.add(
    'idle', Phaser.Animation.generateFrameNames('Idle__', 1, 9, '.png', 3),
    6, true, false
  );

  this.animations.play('idle');
}

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

Player.prototype.update = function() {
  this.isMovingRight = false;

  if (this.willAttack) {
    this.animations.play('attack');
    this.isAttacking = true;
    this.anchor.setTo(0.3, 0.5);
  }

  if (!this.isAttacking) {
    if (this.rightKey.isDown || this.leftKey.isDown) {
      this.isMovingRight = true;
      this.anchor.setTo(0.5, 0.5);
      this.animations.play('run');
    } else {
      this.anchor.setTo(0.5, 0.55);
      this.animations.play('idle');
    }
  }

  this.willAttack = false;
};

Player.prototype.attackFinished = function() {
  this.animations.play('idle');
  this.isAttacking = false;
};

Player.prototype.onAttackInput = function () {
  this.willAttack = true;
};

module.exports = Player;

},{}],"/Users/moret/dev/roosevelt/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {};

Boot.prototype = {
  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth = 480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

module.exports = Boot;

},{}],"/Users/moret/dev/roosevelt/src/js/states/game.js":[function(require,module,exports){
var Player = require('../entities/player');

var Game = function () {
  this.testentity = null;
  this.backgroundSpeed = 0.2;
  this.foregroundSpeed = 3;
};

Game.prototype = {
  create: function () {
    var x = this.game.width / 3;
    var y = 2 * (this.game.height / 3);

    this.sky = this.add.tileSprite(0, 0, this.game.width, this.game.width, 'sky');
    this.cityBackground = this.add.tileSprite(0, 0, this.world.width, this.world.height, 'city-background');
    this.cityForeground = this.add.tileSprite(0, 0, this.world.width, this.world.height, 'city-foreground');

    this.testentity = new Player(this.game, x, y);

    var xKey = this.input.keyboard.addKey(Phaser.Keyboard.X);
    xKey.onDown.add(this.testentity.onAttackInput, this.testentity);

    this.rightKey = this.input.keyboard.addKey(Phaser.Keyboard.RIGHT);
    this.leftKey = this.input.keyboard.addKey(Phaser.Keyboard.LEFT);

    this.testentity.rightKey = this.rightKey;
    this.testentity.leftKey = this.leftKey;

    var escKey = this.input.keyboard.addKey(Phaser.Keyboard.ESC);
    escKey.onDown.add(this.onEscInput, this);
  },

  update: function () {
    if (this.testentity.isMovingRight) {
      this.cityBackground.tilePosition.x -= this.backgroundSpeed;
      this.cityForeground.tilePosition.x -= this.foregroundSpeed;
    } else {
    }
  },

  onEscInput: function () {
    this.game.state.start('Menu');
  }
};

module.exports = Game;

},{"../entities/player":"/Users/moret/dev/roosevelt/src/js/entities/player.js"}],"/Users/moret/dev/roosevelt/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

Menu.prototype = {
  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: '3em "Lucida Console", Monaco, monospace', fill: '#ffffff' };
    this.text = this.add.text(x - 300, y - 200, 'esc        start/stop\nx          attack\nleft/right walk', style);

    var escKey = this.input.keyboard.addKey(Phaser.Keyboard.ESC);
    escKey.onDown.add(this.onEscInput, this);
  },

  update: function () {
  },

  onEscInput: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

module.exports = Menu;

},{}],"/Users/moret/dev/roosevelt/src/js/states/preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

Preloader.prototype = {
  preload: function () {
    this.asset = this.add.sprite(this.game.width / 2, this.game.height / 2, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);

    this.load.image('sky', 'assets/sky.png');
    this.load.image('city-background', 'assets/city-background.png');
    this.load.image('city-foreground', 'assets/city-foreground.png');

    this.load.json('ninja_atlas', 'assets/ninja.json');
    xxx = this.load.atlasJSONHash('ninja', 'assets/ninja.png', 'assets/ninja.json');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Menu');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

module.exports = Preloader;

},{}],"/Users/moret/dev/roosevelt/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"/Users/moret/dev/roosevelt/src/js/utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    }
};

module.exports = Utils;
},{}]},{},["./src/js/main.js"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9lbnRpdGllcy9wbGF5ZXIuanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0JztcblxudmFyIGhlaWdodCA9IDY0ODtcbnZhciB3aWR0aCA9IGhlaWdodCoxNi85O1xudmFyIGdhbWUgPSBuZXcgUGhhc2VyLkdhbWUod2lkdGgsIGhlaWdodCwgUGhhc2VyLkFVVE8sICdyb29zZXZlbHQtZ2FtZScpO1xuXG53aW5kb3cuVXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG53aW5kb3cucGxheWVyU3RhdGUgPSB7Y3VycmVudExldmVsOiAnR2FtZSd9O1xuXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XG5nYW1lLnN0YXRlLmFkZCgnU3BsYXNoJywgcmVxdWlyZSgnLi9zdGF0ZXMvc3BsYXNoJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ1ByZWxvYWRlcicsIHJlcXVpcmUoJy4vc3RhdGVzL3ByZWxvYWRlcicpKTtcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcbmdhbWUuc3RhdGUuYWRkKCdHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvZ2FtZScpKTtcblxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpO1xuIiwidmFyIFBsYXllciA9IGZ1bmN0aW9uIChnYW1lLCB4LCB5KSB7XG4gIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAnbmluamEnLCAnSWRsZV9fMDAxLnBuZycpO1xuICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcbiAgdGhpcy5hbmNob3Iuc2V0VG8oMC41LCAwLjU1KTtcblxuICB0aGlzLmF0dGFja0FuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9ucy5hZGQoXG4gICAgJ2F0dGFjaycsIFBoYXNlci5BbmltYXRpb24uZ2VuZXJhdGVGcmFtZU5hbWVzKCdBdHRhY2tfXycsIDEsIDEwLCAnLnBuZycsIDMpLFxuICAgIDI0LCBmYWxzZSwgZmFsc2VcbiAgKTtcbiAgdGhpcy5hdHRhY2tBbmltYXRpb24ub25Db21wbGV0ZS5hZGQodGhpcy5hdHRhY2tGaW5pc2hlZCwgdGhpcyk7XG5cbiAgdGhpcy5hbmltYXRpb25zLmFkZChcbiAgICAncnVuJywgUGhhc2VyLkFuaW1hdGlvbi5nZW5lcmF0ZUZyYW1lTmFtZXMoJ1J1bl9fJywgMSwgMTAsICcucG5nJywgMyksXG4gICAgMjQsIHRydWUsIGZhbHNlXG4gICk7XG5cbiAgdGhpcy5hbmltYXRpb25zLmFkZChcbiAgICAnaWRsZScsIFBoYXNlci5BbmltYXRpb24uZ2VuZXJhdGVGcmFtZU5hbWVzKCdJZGxlX18nLCAxLCA5LCAnLnBuZycsIDMpLFxuICAgIDYsIHRydWUsIGZhbHNlXG4gICk7XG5cbiAgdGhpcy5hbmltYXRpb25zLnBsYXkoJ2lkbGUnKTtcbn1cblxuUGxheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuUGxheWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBsYXllcjtcblxuUGxheWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5pc01vdmluZ1JpZ2h0ID0gZmFsc2U7XG5cbiAgaWYgKHRoaXMud2lsbEF0dGFjaykge1xuICAgIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdhdHRhY2snKTtcbiAgICB0aGlzLmlzQXR0YWNraW5nID0gdHJ1ZTtcbiAgICB0aGlzLmFuY2hvci5zZXRUbygwLjMsIDAuNSk7XG4gIH1cblxuICBpZiAoIXRoaXMuaXNBdHRhY2tpbmcpIHtcbiAgICBpZiAodGhpcy5yaWdodEtleS5pc0Rvd24gfHwgdGhpcy5sZWZ0S2V5LmlzRG93bikge1xuICAgICAgdGhpcy5pc01vdmluZ1JpZ2h0ID0gdHJ1ZTtcbiAgICAgIHRoaXMuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcbiAgICAgIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdydW4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hbmNob3Iuc2V0VG8oMC41LCAwLjU1KTtcbiAgICAgIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdpZGxlJyk7XG4gICAgfVxuICB9XG5cbiAgdGhpcy53aWxsQXR0YWNrID0gZmFsc2U7XG59O1xuXG5QbGF5ZXIucHJvdG90eXBlLmF0dGFja0ZpbmlzaGVkID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdpZGxlJyk7XG4gIHRoaXMuaXNBdHRhY2tpbmcgPSBmYWxzZTtcbn07XG5cblBsYXllci5wcm90b3R5cGUub25BdHRhY2tJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy53aWxsQXR0YWNrID0gdHJ1ZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGxheWVyO1xuIiwidmFyIEJvb3QgPSBmdW5jdGlvbiAoKSB7fTtcblxuQm9vdC5wcm90b3R5cGUgPSB7XG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XG5cbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XG4gICAgICB0aGlzLmdhbWUuc3RhZ2Uuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSA0ODA7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gMjYwO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0gNjQwO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heEhlaWdodCA9IDQ4MDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mb3JjZUxhbmRzY2FwZSA9IHRydWU7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zZXRTY3JlZW5TaXplKHRydWUpO1xuICAgIH1cblxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnUHJlbG9hZGVyJyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcbiIsInZhciBQbGF5ZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9wbGF5ZXInKTtcblxudmFyIEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XG4gIHRoaXMuYmFja2dyb3VuZFNwZWVkID0gMC4yO1xuICB0aGlzLmZvcmVncm91bmRTcGVlZCA9IDM7XG59O1xuXG5HYW1lLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAzO1xuICAgIHZhciB5ID0gMiAqICh0aGlzLmdhbWUuaGVpZ2h0IC8gMyk7XG5cbiAgICB0aGlzLnNreSA9IHRoaXMuYWRkLnRpbGVTcHJpdGUoMCwgMCwgdGhpcy5nYW1lLndpZHRoLCB0aGlzLmdhbWUud2lkdGgsICdza3knKTtcbiAgICB0aGlzLmNpdHlCYWNrZ3JvdW5kID0gdGhpcy5hZGQudGlsZVNwcml0ZSgwLCAwLCB0aGlzLndvcmxkLndpZHRoLCB0aGlzLndvcmxkLmhlaWdodCwgJ2NpdHktYmFja2dyb3VuZCcpO1xuICAgIHRoaXMuY2l0eUZvcmVncm91bmQgPSB0aGlzLmFkZC50aWxlU3ByaXRlKDAsIDAsIHRoaXMud29ybGQud2lkdGgsIHRoaXMud29ybGQuaGVpZ2h0LCAnY2l0eS1mb3JlZ3JvdW5kJyk7XG5cbiAgICB0aGlzLnRlc3RlbnRpdHkgPSBuZXcgUGxheWVyKHRoaXMuZ2FtZSwgeCwgeSk7XG5cbiAgICB2YXIgeEtleSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5YKTtcbiAgICB4S2V5Lm9uRG93bi5hZGQodGhpcy50ZXN0ZW50aXR5Lm9uQXR0YWNrSW5wdXQsIHRoaXMudGVzdGVudGl0eSk7XG5cbiAgICB0aGlzLnJpZ2h0S2V5ID0gdGhpcy5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlJJR0hUKTtcbiAgICB0aGlzLmxlZnRLZXkgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuTEVGVCk7XG5cbiAgICB0aGlzLnRlc3RlbnRpdHkucmlnaHRLZXkgPSB0aGlzLnJpZ2h0S2V5O1xuICAgIHRoaXMudGVzdGVudGl0eS5sZWZ0S2V5ID0gdGhpcy5sZWZ0S2V5O1xuXG4gICAgdmFyIGVzY0tleSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5FU0MpO1xuICAgIGVzY0tleS5vbkRvd24uYWRkKHRoaXMub25Fc2NJbnB1dCwgdGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMudGVzdGVudGl0eS5pc01vdmluZ1JpZ2h0KSB7XG4gICAgICB0aGlzLmNpdHlCYWNrZ3JvdW5kLnRpbGVQb3NpdGlvbi54IC09IHRoaXMuYmFja2dyb3VuZFNwZWVkO1xuICAgICAgdGhpcy5jaXR5Rm9yZWdyb3VuZC50aWxlUG9zaXRpb24ueCAtPSB0aGlzLmZvcmVncm91bmRTcGVlZDtcbiAgICB9IGVsc2Uge1xuICAgIH1cbiAgfSxcblxuICBvbkVzY0lucHV0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcbiIsInZhciBNZW51ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnRleHQgPSBudWxsO1xufTtcblxuTWVudS5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcbiAgICB2YXIgeSA9IHRoaXMuZ2FtZS5oZWlnaHQgLyAyO1xuXG4gICAgdmFyIHN0eWxlID0geyBmb250OiAnM2VtIFwiTHVjaWRhIENvbnNvbGVcIiwgTW9uYWNvLCBtb25vc3BhY2UnLCBmaWxsOiAnI2ZmZmZmZicgfTtcbiAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsICdlc2MgICAgICAgIHN0YXJ0L3N0b3BcXG54ICAgICAgICAgIGF0dGFja1xcbmxlZnQvcmlnaHQgd2FsaycsIHN0eWxlKTtcblxuICAgIHZhciBlc2NLZXkgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuRVNDKTtcbiAgICBlc2NLZXkub25Eb3duLmFkZCh0aGlzLm9uRXNjSW5wdXQsIHRoaXMpO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICB9LFxuXG4gIG9uRXNjSW5wdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBNZW51O1xuIiwidmFyIFByZWxvYWRlciA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gIHRoaXMuYXNzZXQgPSBudWxsO1xuICB0aGlzLnJlYWR5ID0gZmFsc2U7XG59O1xuXG5QcmVsb2FkZXIucHJvdG90eXBlID0ge1xuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSh0aGlzLmdhbWUud2lkdGggLyAyLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiwgJ3ByZWxvYWRlcicpO1xuICAgIHRoaXMuYXNzZXQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMuYXNzZXQpO1xuXG4gICAgdGhpcy5sb2FkLmltYWdlKCdza3knLCAnYXNzZXRzL3NreS5wbmcnKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2NpdHktYmFja2dyb3VuZCcsICdhc3NldHMvY2l0eS1iYWNrZ3JvdW5kLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnY2l0eS1mb3JlZ3JvdW5kJywgJ2Fzc2V0cy9jaXR5LWZvcmVncm91bmQucG5nJyk7XG5cbiAgICB0aGlzLmxvYWQuanNvbignbmluamFfYXRsYXMnLCAnYXNzZXRzL25pbmphLmpzb24nKTtcbiAgICB4eHggPSB0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnbmluamEnLCAnYXNzZXRzL25pbmphLnBuZycsICdhc3NldHMvbmluamEuanNvbicpO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISF0aGlzLnJlYWR5KSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcbiAgICB9XG4gIH0sXG5cbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKCkge1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTcGxhc2g7XG5cblNwbGFzaC5wcm90b3R5cGUgPSB7XG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICB9XG59OyIsInZhciBVdGlscyA9IHtcbiAgICBjb250YWluc09iamVjdDogZnVuY3Rpb24ob2JqLCBsaXN0KSB7XG4gICAgICAgIHZhciBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IG9iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXRpbHM7Il19
